{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Show real React Query errors for Client Shipments and Delivery History",
  "requirements": [
    {
      "id": "REQ-3",
      "summary": "Improve Client Shipments/Delivery History error UI to surface actionable React Query error messages with safe English fallbacks.",
      "acceptanceCriteria": [
        "When shipment/history loading fails, the UI renders a user-friendly message derived from the thrown error (e.g., session expired, account not linked, service unavailable), not only the fixed generic string.",
        "The UI continues to show a safe generic fallback message if the error is missing/empty/too technical.",
        "No changes are made to read-only paths listed in `frontend.immutablePaths`."
      ],
      "file_operations": [
        {
          "path": "frontend/src/utils/queryErrorMessage.ts",
          "operation": "create",
          "description": "Add a small utility to turn React Query thrown errors into safe, user-facing English messages (prefer error.message when already user-friendly; otherwise map via existing getClientAuthErrorMessage; otherwise return a generic fallback)."
        },
        {
          "path": "frontend/src/components/client/ClientShipmentsTable.tsx",
          "operation": "modify",
          "description": "Replace the fixed generic red-alert text for Shipments and Delivery History with a message produced from the React Query `error` (via the new queryErrorMessage helper), while preserving the existing special handling for linkage errors and keeping all user-facing text in English."
        }
      ]
    }
  ]
}